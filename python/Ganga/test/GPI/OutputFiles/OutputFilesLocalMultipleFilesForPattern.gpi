from GangaTest.Framework.utils import sleep_until_completed

j = Job(application=Root(),backend=Local())

j.application.script = File('fillrandom2.py')

j.outputfiles = ['*.root']

assert(j.outputfiles[0].__class__.__name__ == 'LCGStorageElementFile')

j.submit()

assert(sleep_until_completed(j,180))

assert(j.outputfiles[0].location() != [])

j.outputfiles[0].get(j.outputdir)

for filename in [j.outputfiles[0].location()[0][-10:], j.outputfiles[0].location()[1][-10:], j.outputfiles[0].location()[2][-10:]]:
    assert(filename in os.listdir(j.outputdir)) 
    
